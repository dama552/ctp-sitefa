{% extends 'inicio/inicio.html' %}

{% block section %}

    <div class="header">
        <h1><i class="fas fa-edit header-icon"></i> Registrar Asistencia</h1>
    </div>

    <!-- Muestra errores del formulario -->
    {% if form.errors %}
        <div class="alert alert-danger mt-3">
            <h5>Por favor, corrige los siguientes errores:</h5>
            <ul>
                {% for field, errors in form.errors.items %}
                    <li><strong>{{ field }}:</strong> {{ errors|join:", " }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <form method="post" class="mt-4">
        {% csrf_token %}

        <!-- Selección de estudiante -->
        <div class="mb-3">
            {{ form.estudiante.label_tag }} {{ form.estudiante }}
        </div>

        <!-- Selección de materia -->
        <div class="mb-3">
            {{ form.materia.label_tag }} {{ form.materia }}
        </div>

        <!-- Switch de asistencia -->
        <div class="mb-3 form-check form-switch">
            <input class="form-check-input" type="checkbox" id="id_presente"
                   name="{{ form.presente.name }}" {% if form.presente.value %}checked{% endif %}>
            <label class="form-check-label" for="id_presente"><strong>Presente</strong></label>
        </div>

        <!-- Justificación -->
        <div id="justificacion-container" class="mb-3 {% if form.presente.value %}d-none{% endif %}">
            {{ form.justificacion.label_tag }} {{ form.justificacion }}
        </div>

        <div class="d-flex justify-content-end gap-2">
            <a href="{% url 'asistencia:asistencia_leer' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Volver a la lista
            </a>
            <button type="submit" class="btn btn-success">
                <i class="fas fa-save"></i> Guardar Asistencia
            </button>

    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const presenteCheckbox = document.getElementById('id_presente');
        const justificacionContainer = document.getElementById('justificacion-container');

        function toggleJustificacion() {
            if (presenteCheckbox.checked) {
                justificacionContainer.classList.add('d-none');
            } else {
                justificacionContainer.classList.remove('d-none');
            }
        }

        toggleJustificacion();
        presenteCheckbox.addEventListener('change', toggleJustificacion);
    });
</script>
{% endblock %}
